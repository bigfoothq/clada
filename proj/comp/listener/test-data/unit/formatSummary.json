{
  "cases": [
    {
      "name": "empty results",
      "input": [
        {
          "actions": [],
          "errors": [],
          "summary": {"totalBlocks": 0, "successCount": 0, "errorCount": 0}
        },
        [],
        "2024-03-15T10:30:45.000Z"
      ],
      "expected": "\n=== CLADA RESULTS ===\n=== END ===\n"
    },
    {
      "name": "single successful action",
      "input": [
        {
          "actions": [
            {
              "action": "file_write",
              "parameters": {"path": "/tmp/test.txt", "content": "hello"},
              "metadata": {"blockId": "k7m", "startLine": 1, "endLine": 5}
            }
          ],
          "errors": [],
          "summary": {"totalBlocks": 1, "successCount": 1, "errorCount": 0}
        },
        [
          {
            "action": {
              "action": "file_write",
              "parameters": {"path": "/tmp/test.txt", "content": "hello"},
              "metadata": {"blockId": "k7m", "startLine": 1, "endLine": 5}
            },
            "result": {"success": true}
          }
        ],
        "2024-03-15T10:30:45.000Z"
      ],
      "expected": "\n=== CLADA RESULTS ===\nk7m ✅ file_write /tmp/test.txt\n=== END ===\n"
    },
    {
      "name": "single failed action",
      "input": [
        {
          "actions": [
            {
              "action": "file_read",
              "parameters": {"path": "/tmp/missing.txt"},
              "metadata": {"blockId": "abc", "startLine": 1, "endLine": 3}
            }
          ],
          "errors": [],
          "summary": {"totalBlocks": 1, "successCount": 0, "errorCount": 1}
        },
        [
          {
            "action": {
              "action": "file_read",
              "parameters": {"path": "/tmp/missing.txt"},
              "metadata": {"blockId": "abc", "startLine": 1, "endLine": 3}
            },
            "result": {
              "success": false,
              "error": "file_read: File not found '/tmp/missing.txt' (ENOENT)"
            }
          }
        ],
        "2024-03-15T10:30:45.000Z"
      ],
      "expected": "\n=== CLADA RESULTS ===\nabc ❌ file_read /tmp/missing.txt - File not found\n=== END ===\n"
    },
    {
      "name": "mixed success and failure",
      "input": [
        {
          "actions": [
            {
              "action": "file_write",
              "parameters": {"path": "/tmp/good.txt", "content": "data"},
              "metadata": {"blockId": "aaa", "startLine": 1, "endLine": 5}
            },
            {
              "action": "file_delete",
              "parameters": {"path": "/tmp/missing.txt"},
              "metadata": {"blockId": "bbb", "startLine": 6, "endLine": 8}
            }
          ],
          "errors": [],
          "summary": {"totalBlocks": 2, "successCount": 1, "errorCount": 1}
        },
        [
          {
            "action": {
              "action": "file_write",
              "parameters": {"path": "/tmp/good.txt", "content": "data"},
              "metadata": {"blockId": "aaa", "startLine": 1, "endLine": 5}
            },
            "result": {"success": true}
          },
          {
            "action": {
              "action": "file_delete",
              "parameters": {"path": "/tmp/missing.txt"},
              "metadata": {"blockId": "bbb", "startLine": 6, "endLine": 8}
            },
            "result": {
              "success": false,
              "error": "file_delete: File not found '/tmp/missing.txt' (ENOENT)"
            }
          }
        ],
        "2024-03-15T10:30:45.000Z"
      ],
      "expected": "\n=== CLADA RESULTS ===\naaa ✅ file_write /tmp/good.txt\nbbb ❌ file_delete /tmp/missing.txt - File not found\n=== END ===\n"
    },
    {
      "name": "parse errors only",
      "input": [
        {
          "actions": [],
          "errors": [
            {
              "blockId": "xyz",
              "action": "file_write",
              "errorType": "validation",
              "message": "Missing required parameter: path",
              "blockStartLine": 1
            },
            {
              "blockId": "uvw",
              "errorType": "syntax",
              "message": "Invalid SHAM syntax: Expected '=' after key",
              "blockStartLine": 5
            }
          ],
          "summary": {"totalBlocks": 2, "successCount": 0, "errorCount": 2}
        },
        [],
        "2024-03-15T10:30:45.000Z"
      ],
      "expected": "\n=== CLADA RESULTS ===\nxyz ❌ file_write - Missing required parameter: path\nuvw ❌ (parse error) - Invalid SHAM syntax: Expected '=' after key\n=== END ===\n"
    },
    {
      "name": "exec with language parameter",
      "input": [
        {
          "actions": [
            {
              "action": "exec",
              "parameters": {"lang": "python", "code": "print('hello')"},
              "metadata": {"blockId": "py1", "startLine": 1, "endLine": 3}
            }
          ],
          "errors": [],
          "summary": {"totalBlocks": 1, "successCount": 1, "errorCount": 0}
        },
        [
          {
            "action": {
              "action": "exec",
              "parameters": {"lang": "python", "code": "print('hello')"},
              "metadata": {"blockId": "py1", "startLine": 1, "endLine": 3}
            },
            "result": {"success": true, "stdout": "hello\n", "stderr": "", "exit_code": 0}
          }
        ],
        "2024-03-15T10:30:45.000Z"
      ],
      "expected": "\n=== CLADA RESULTS ===\npy1 ✅ exec python\n=== END ===\n"
    },
    {
      "name": "files_read with multiline paths",
      "input": [
        {
          "actions": [
            {
              "action": "files_read",
              "parameters": {
                "paths": "/tmp/file1.txt\n/tmp/file2.txt\n/tmp/file3.txt"
              },
              "metadata": {"blockId": "fr1", "startLine": 1, "endLine": 5}
            }
          ],
          "errors": [],
          "summary": {"totalBlocks": 1, "successCount": 1, "errorCount": 0}
        },
        [
          {
            "action": {
              "action": "files_read",
              "parameters": {
                "paths": "/tmp/file1.txt\n/tmp/file2.txt\n/tmp/file3.txt"
              },
              "metadata": {"blockId": "fr1", "startLine": 1, "endLine": 5}
            },
            "result": {"success": true, "content": "... file contents ..."}
          }
        ],
        "2024-03-15T10:30:45.000Z"
      ],
      "expected": "\n=== CLADA RESULTS ===\nfr1 ✅ files_read (3 files)\n=== END ===\n"
    },
    {
      "name": "action with no recognizable primary param",
      "input": [
        {
          "actions": [
            {
              "action": "custom_action",
              "parameters": {"foo": "bar"},
              "metadata": {"blockId": "cst", "startLine": 1, "endLine": 3}
            }
          ],
          "errors": [],
          "summary": {"totalBlocks": 1, "successCount": 1, "errorCount": 0}
        },
        [
          {
            "action": {
              "action": "custom_action",
              "parameters": {"foo": "bar"},
              "metadata": {"blockId": "cst", "startLine": 1, "endLine": 3}
            },
            "result": {"success": true}
          }
        ],
        "2024-03-15T10:30:45.000Z"
      ],
      "expected": "\n=== CLADA RESULTS ===\ncst ✅ custom_action\n=== END ===\n"
    },
    {
      "name": "chronological ordering by line number",
      "input": [
        {
          "actions": [
            {
              "action": "file_write",
              "parameters": {"path": "/tmp/third.txt", "content": "3"},
              "metadata": {"blockId": "trd", "startLine": 10, "endLine": 12}
            },
            {
              "action": "file_write",
              "parameters": {"path": "/tmp/first.txt", "content": "1"},
              "metadata": {"blockId": "fst", "startLine": 1, "endLine": 3}
            },
            {
              "action": "file_write",
              "parameters": {"path": "/tmp/second.txt", "content": "2"},
              "metadata": {"blockId": "snd", "startLine": 5, "endLine": 7}
            }
          ],
          "errors": [
            {
              "blockId": "err",
              "errorType": "syntax",
              "message": "Invalid syntax",
              "blockStartLine": 8
            }
          ],
          "summary": {"totalBlocks": 4, "successCount": 3, "errorCount": 1}
        },
        [
          {
            "action": {
              "action": "file_write",
              "parameters": {"path": "/tmp/third.txt", "content": "3"},
              "metadata": {"blockId": "trd", "startLine": 10, "endLine": 12}
            },
            "result": {"success": true}
          },
          {
            "action": {
              "action": "file_write",
              "parameters": {"path": "/tmp/first.txt", "content": "1"},
              "metadata": {"blockId": "fst", "startLine": 1, "endLine": 3}
            },
            "result": {"success": true}
          },
          {
            "action": {
              "action": "file_write",
              "parameters": {"path": "/tmp/second.txt", "content": "2"},
              "metadata": {"blockId": "snd", "startLine": 5, "endLine": 7}
            },
            "result": {"success": true}
          }
        ],
        "2024-03-15T10:30:45.000Z"
      ],
      "expected": "\n=== CLADA RESULTS ===\nfst ✅ file_write /tmp/first.txt\nsnd ✅ file_write /tmp/second.txt\nerr ❌ (parse error) - Invalid syntax\ntrd ✅ file_write /tmp/third.txt\n=== END ===\n"
    }
  ]
}