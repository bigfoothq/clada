 {
  "cases": [
    {
      "name": "valid file_create action",
      "input": [
        {
          "id": "abc",
          "properties": {
            "action": "file_create",
            "path": "/tmp/test.txt",
            "content": "hello world"
          },
          "startLine": 1,
          "endLine": 5
        },
        {
          "file_create": {
            "parameters": {
              "path": {"type": "string", "required": true},
              "content": {"type": "string", "required": true}
            }
          }
        }
      ],
      "expected": {
        "valid": true,
        "block": {
          "id": "abc",
          "properties": {
            "action": "file_create",
            "path": "/tmp/test.txt",
            "content": "hello world"
          },
          "startLine": 1,
          "endLine": 5
        }
      }
    },
    {
      "name": "unknown action",
      "input": [
        {
          "id": "xyz",
          "properties": {
            "action": "invalid_action",
            "path": "/tmp/test.txt"
          },
          "startLine": 1,
          "endLine": 3
        },
        {
          "file_create": {
            "parameters": {
              "path": {"type": "string", "required": true},
              "content": {"type": "string", "required": true}
            }
          },
          "file_write": {
            "parameters": {
              "path": {"type": "string", "required": true},
              "content": {"type": "string", "required": true}
            }
          }
        }
      ],
      "expected": {
        "valid": false,
        "error": {
          "code": "UNKNOWN_ACTION",
          "action": "invalid_action",
          "availableActions": ["file_create", "file_write"],
          "message": "Unknown action 'invalid_action'. Available actions: file_create, file_write"
        }
      }
    },
    {
      "name": "missing required parameter",
      "input": [
        {
          "id": "def",
          "properties": {
            "action": "file_create",
            "path": "/tmp/test.txt"
          },
          "startLine": 1,
          "endLine": 3
        },
        {
          "file_create": {
            "parameters": {
              "path": {"type": "string", "required": true},
              "content": {"type": "string", "required": true}
            }
          }
        }
      ],
      "expected": {
        "valid": false,
        "error": {
          "code": "MISSING_PARAM",
          "action": "file_create",
          "param": "content",
          "message": "Missing required parameter 'content' for action 'file_create'"
        }
      }
    },
    {
      "name": "invalid parameter type",
      "input": [
        {
          "id": "ghi",
          "properties": {
            "action": "exec",
            "code": "print('hello')",
            "lang": "python",
            "timeout": "30s"
          },
          "startLine": 1,
          "endLine": 5
        },
        {
          "exec": {
            "parameters": {
              "code": {"type": "string", "required": true},
              "lang": {"type": "enum", "values": ["python", "javascript", "bash", "ruby"], "required": true},
              "timeout": {"type": "integer", "required": false}
            }
          }
        }
      ],
      "expected": {
        "valid": false,
        "error": {
          "code": "INVALID_TYPE",
          "action": "exec",
          "param": "timeout",
          "expected": "integer",
          "actual": "string",
          "message": "Invalid type for parameter 'timeout' in action 'exec': expected integer, got string"
        }
      }
    },
    {
      "name": "invalid enum value",
      "input": [
        {
          "id": "jkl",
          "properties": {
            "action": "exec",
            "code": "print('hello')",
            "lang": "perl"
          },
          "startLine": 1,
          "endLine": 4
        },
        {
          "exec": {
            "parameters": {
              "code": {"type": "string", "required": true},
              "lang": {"type": "enum", "values": ["python", "javascript", "bash", "ruby"], "required": true}
            }
          }
        }
      ],
      "expected": {
        "valid": false,
        "error": {
          "code": "INVALID_TYPE",
          "action": "exec",
          "param": "lang",
          "expected": "enum[python,javascript,bash,ruby]",
          "actual": "perl",
          "message": "Invalid value for parameter 'lang' in action 'exec': expected one of [python,javascript,bash,ruby], got 'perl'"
        }
      }
    },
    {
      "name": "extra parameters allowed",
      "input": [
        {
          "id": "mno",
          "properties": {
            "action": "file_create",
            "path": "/tmp/test.txt",
            "content": "hello",
            "extra": "ignored",
            "another": 123
          },
          "startLine": 1,
          "endLine": 7
        },
        {
          "file_create": {
            "parameters": {
              "path": {"type": "string", "required": true},
              "content": {"type": "string", "required": true}
            }
          }
        }
      ],
      "expected": {
        "valid": true,
        "block": {
          "id": "mno",
          "properties": {
            "action": "file_create",
            "path": "/tmp/test.txt",
            "content": "hello",
            "extra": "ignored",
            "another": 123
          },
          "startLine": 1,
          "endLine": 7
        }
      }
    },
    {
      "name": "null value for required parameter",
      "input": [
        {
          "id": "pqr",
          "properties": {
            "action": "file_create",
            "path": "/tmp/test.txt",
            "content": null
          },
          "startLine": 1,
          "endLine": 4
        },
        {
          "file_create": {
            "parameters": {
              "path": {"type": "string", "required": true},
              "content": {"type": "string", "required": true}
            }
          }
        }
      ],
      "expected": {
        "valid": false,
        "error": {
          "code": "MISSING_PARAM",
          "action": "file_create",
          "param": "content",
          "message": "Missing required parameter 'content' for action 'file_create'"
        }
      }
    },
    {
      "name": "empty string valid for string type",
      "input": [
        {
          "id": "stu",
          "properties": {
            "action": "file_create",
            "path": "/tmp/empty.txt",
            "content": ""
          },
          "startLine": 1,
          "endLine": 4
        },
        {
          "file_create": {
            "parameters": {
              "path": {"type": "string", "required": true},
              "content": {"type": "string", "required": true}
            }
          }
        }
      ],
      "expected": {
        "valid": true,
        "block": {
          "id": "stu",
          "properties": {
            "action": "file_create",
            "path": "/tmp/empty.txt",
            "content": ""
          },
          "startLine": 1,
          "endLine": 4
        }
      }
    },
    {
      "name": "boolean type validation",
      "input": [
        {
          "id": "vwx",
          "properties": {
            "action": "dir_create",
            "path": "/tmp/mydir",
            "recursive": "true"
          },
          "startLine": 1,
          "endLine": 4
        },
        {
          "dir_create": {
            "parameters": {
              "path": {"type": "string", "required": true},
              "recursive": {"type": "boolean", "required": false}
            }
          }
        }
      ],
      "expected": {
        "valid": false,
        "error": {
          "code": "INVALID_TYPE",
          "action": "dir_create",
          "param": "recursive",
          "expected": "boolean",
          "actual": "string",
          "message": "Invalid type for parameter 'recursive' in action 'dir_create': expected boolean, got string"
        }
      }
    },
    {
      "name": "integer type validation - valid",
      "input": [
        {
          "id": "yz1",
          "properties": {
            "action": "file_edit",
            "path": "/tmp/test.txt",
            "old_text": "foo",
            "new_text": "bar",
            "count": 5
          },
          "startLine": 1,
          "endLine": 6
        },
        {
          "file_edit": {
            "parameters": {
              "path": {"type": "string", "required": true},
              "old_text": {"type": "string", "required": true},
              "new_text": {"type": "string", "required": true},
              "count": {"type": "integer", "required": false}
            }
          }
        }
      ],
      "expected": {
        "valid": true,
        "block": {
          "id": "yz1",
          "properties": {
            "action": "file_edit",
            "path": "/tmp/test.txt",
            "old_text": "foo",
            "new_text": "bar",
            "count": 5
          },
          "startLine": 1,
          "endLine": 6
        }
      }
    },
    {
      "name": "integer type validation - float rejected",
      "input": [
        {
          "id": "234",
          "properties": {
            "action": "file_edit",
            "path": "/tmp/test.txt",
            "old_text": "foo",
            "new_text": "bar",
            "count": 5.5
          },
          "startLine": 1,
          "endLine": 6
        },
        {
          "file_edit": {
            "parameters": {
              "path": {"type": "string", "required": true},
              "old_text": {"type": "string", "required": true},
              "new_text": {"type": "string", "required": true},
              "count": {"type": "integer", "required": false}
            }
          }
        }
      ],
      "expected": {
        "valid": false,
        "error": {
          "code": "INVALID_TYPE",
          "action": "file_edit",
          "param": "count",
          "expected": "integer",
          "actual": "number",
          "message": "Invalid type for parameter 'count' in action 'file_edit': expected integer, got number"
        }
      }
    }
  ]
}